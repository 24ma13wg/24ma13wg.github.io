<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Could a brown bear, a black bear, and a polar bear meet?</title>
    <link href="https://fonts.googleapis.com/css?family=Work+Sans:light,semibold" rel="stylesheet">
    <link href="../css/style.css" media="all" rel="stylesheet" />
    <link href="css/style.css" media="all" rel="stylesheet" />
    <link rel="icon" href="https://pages.github.com/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="https://24ma13wg.github.io/could-brown-bear-black-bear-polar-bear-meet/page.html" />
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/topojson.v2.min.js"></script>
    <script src="https://unpkg.com/versor@0.0.1/build/versor.min.js"></script>
    <script src="https://unpkg.com/d3-inertia@0.0.4/build/d3-inertia.min.js"></script>
  </head>
  <body>
    <nav>
      <small><a href="/">Home</a></small>
    </nav>
    <h1>Could a brown bear, a black bear, and a polar bear meet?</h1>
    <small>
      <time datetime="2017-12-06 00:00">December, 2017</time>
    </small>
    <div class="bears">
      <p class="lead">The answer is: yes. In this post, I'll show you where with a data visualisation; I'll explain how it is constructed with <a href="https://d3js.org/" target="_blank">d3.js</a>; and then extend this example to demonstrate some more complex interactions.</p>
      <h2>Bear range</h2>
      <p>A brown bear, black bear, and polar bear could cross paths in northern parts of Canada or Alaska. We can see this in the data visualisation, below, which shows some of the (overlapping) areas over which different species of bear range. Such meetings are likely becoming more common as a warmer climate pushes brown bears further north, and polar bears further south, off of the sea ice, onto land. Sightings of polar-brown bear hybrids (<a href="http://sciencenordic.com/grizzly-polar-bear-hybrids-spotted-canadian-arctic" target="_blank">grolar bears</a>) are concrete evidence of such meetings.</p>
      <div class="container-1"><svg height="600" width="600"></svg></div>
      <figcaption>Meeting points</figcaption>
      <p>In general, bears like to live in the north. In fact, no one species of bear lives exclusively south of the equator. The most southerly ranging are spectacled bears. These bears live in the Andes mountains of South America, and live as far south as Argentina.</p>
      <div class="wrapper-for-2-3"><span class="container-2"><svg height="300" width="300"></svg></span><span class="container-3"><svg height="300" width="300"></svg></span></div>
      <figcaption>Northerners</figcaption>
      <p>Insights like these would be difficult to know from, and describe with, tables and charts. Therefore, this is an excellent use case for a data visualisation: the goal of which is to aid discovery, and explain something about the world.</p>
      <h2>Web page cartography</h2>
      <p>The data visualisations on this page are built with a JavaScript library called d3.js. With this library we can load large amounts of data, and construct visual representations of it with HTML, CSS and SVG. Data can be found from an increasing variety of sources, as more and more organisations make their data freely available to everyone. Of course, we are not limited to data downloads. Data could come from anywhere: from user data, captured by a website; or from a web service; or from another source.</p>
      <p>D3.js can do many things, and is particularly good for cartography. My process for making these maps is as follows: first download, or trace, the geometry (polygons). Two geometry collections are required: the countries of the world, and the known range of terrestrial mammals. To work with this data I convert it into a more friendly format, called GeoJSON. Next, I filter out all mammals, except bears. I then filter out any redundant data properties, like country names, and add some new properties, like common species names. Finally, I simplify, reduce, and compress the data into another format, called TopoJSON. My data files are now, together, less than 200KB. Phew! All I need to do now is to write the JavaScript. This involves loading the data, projecting the spherical geometry onto a plane, and generating the SVG markup. In this case, I have used an orthographic projection because they are good for displaying globes, but many different projections are possible.</p>
      <div class="container-4"><svg height="600" width="600"></svg></div>
      <figcaption>Orthographic projection</figcaption>
      <p>More specifically, what d3.js is doing here is projecting geographic coordinates into SVG path data. For each shape, like the outline of a country, a path element is generated. Each path element contains a path data attribute, which is assigned a list of instructions for drawing the shape. SVG is a lot like HTML and, like HTML, SVG elements can be selected and styled with property-value pairs. In this example, I've declared a class on each range shape, named according to the bear that ranges over that area. I've then targeted each class with a fill representing the bear's fur colour. So, the polar bear shape is filled with a cream colour, the brown bear with brown, and so on.</p>
      <h2>Giant pandas</h2>
      <p>Back to bears, which in Asia are generally much smaller – and friendlier – than elsewhere. The areas in which they inhabit are smaller too. Sadly most species in the region are classified as vulnerable, mainly due to a loss of their habitats, which are shrinking due to human activity. Giant panda's now occupy just a few mountain ranges in central China (red area, below); there are less than 2000 remaining in the wild.</p>
      <div class="container-5"><svg height="300" width="300"></svg></div>
      <figcaption>Panda country</figcaption>
      <p>The good news for our bamboo eating friends is that, thanks to conservation efforts, giant panda numbers are increasing again. Their status was recently changed from 'endangered' to 'vulnerable', following a 17% population increase over a decade.</p>
      <div class="video-container"><div class="iframe-container"><iframe src="https://www.youtube.com/embed/EHJxUpqriug?rel=0" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe></div></div>
      <h2>Interactive globe</h2>
      <p>All of the data visualisations, above, are generated by a single script and data set. I'm simply passing in different values for width, height, zoom, rotation etc. It would be a trivial matter to provide a user interface to enable any page visitor to pass in their own values, but let's instead make a globe that's more like the real thing.</p>
      <div class="container-6"><svg height="600" width="600"></svg></div>
      <figcaption>Give it a spin</figcaption>
      <p>This globe shows the range of black bears (black area, above). It can be rotated by dragging it in any direction. The rotation applied to the globe results from the initial pointer selection and its subsequent end position. This method is made available by the <a href="https://github.com/Fil/d3-inertia" target="_blank">d3-inertia</a> extension, which builds upon the concept of versor dragging. The <a href="https://www.jasondavies.com/maps/rotate/" target="_blank">use of versors  to calculate rotation</a>, involves some complex mathematics, and we probably shouldn't go there.</p>
      <p>If you have explored this globe, you may have guessed that there are two species of black bear: North American and Asian. They are very similar, and the most common species of bear – but they're not always easy to find. Black bears are good sleepers, and they can spend more than half of their lives hibernating. While they sleep their hearts may beat only eight times in a minute, and they can lose a third of their weight before they wake up.</p>
      <p>And that about covers it. The only two species of bear that I haven't mentioned are sun bears and sloth bears. In regard to d3.js and cartography, another feature we could add would be to make the globe zoomable, but this is more appropriate to more complex and detailed geometries.</p>
      <p>To learn more about the threats that bears face, I recommend the <a href="http://www.iucnredlist.org/" target="_blank">IUCN red list</a>. To learn more about the techniques used to make data visualisations like these, I recommend Mike Bostock's excellent series on <a href="https://medium.com/@mbostock/command-line-cartography-part-1-897aa8f8ca2c" target="_blank">command line cartography</a>. You may also want to checkout <a href="https://observablehq.com/" target="_blank">interactive notebooks</a> too.</p>
      <footer>
        <p><em>Data: Natural Earth Data + IUCN Red List</em></p>
        <p class="call-to-action message"><svg width="50" height="50"><path d="m24.7,49.39999c-2.90139,0 -5.72643,-1.14529 -7.78794,-3.2068l-13.70525,-13.74343c-4.27573,-4.31391 -4.27573,-11.26198 0,-15.53771l13.70525,-13.70525c4.31391,-4.27573 11.26198,-4.27573 15.53771,0l13.74343,13.70525c4.27573,4.31391 4.27573,11.26198 0,15.53771l-13.70525,13.74343c-2.06151,2.06151 -4.88655,3.24498 -7.78794,3.2068z"/><path fill="white" d="m32.48794,19.04992c0.03818,0.45811 -0.22906,0.87805 -0.649,0.99258c-0.72535,0.19088 -1.41252,-0.26723 -2.78686,-0.72535c-0.30541,-0.11453 -1.29799,-0.49629 -1.71793,-0.61082c-0.53447,-0.1527 -1.10711,-0.22906 -1.67975,-0.30541c-0.649,-0.11453 -1.33617,0.07635 -1.83246,0.45811c-0.41994,0.26723 -0.649,0.76352 -0.649,1.25981c0,0.38176 0.1527,0.72535 0.41994,0.9544c0.34359,0.26723 0.72535,0.49629 1.10711,0.68717c0.45811,0.19088 2.74869,0.91623 3.35951,1.14529c0.61082,0.22906 1.22164,0.45811 1.79428,0.76352c0.57264,0.26723 1.10711,0.649 1.56522,1.06893c0.45811,0.41994 0.83988,0.9544 1.10711,1.52705c0.30541,0.68717 0.45811,1.41252 0.41994,2.17604c0,0.9544 -0.19088,1.90881 -0.57264,2.82504c-0.38176,0.87805 -0.9544,1.64158 -1.71793,2.2524c-0.83988,0.649 -1.79428,1.14529 -2.78686,1.4507c-1.22164,0.38176 -2.51963,0.53447 -3.81762,0.53447c-0.72535,0 -1.4507,-0.07635 -2.17604,-0.19088s-1.41252,-0.30541 -2.09969,-0.53447c-0.649,-0.22906 -1.25981,-0.49629 -1.87063,-0.8017c-0.53447,-0.26723 -1.03076,-0.61082 -1.48887,-0.99258l1.48887,-2.63416c0.1527,-0.26723 0.38176,-0.45811 0.649,-0.649c0.30541,-0.1527 0.61082,-0.22906 0.9544,-0.22906s0.68717,0.07635 0.99258,0.22906l0.9544,0.53447c0.38176,0.19088 0.8017,0.38176 1.18346,0.53447c0.57264,0.19088 1.14529,0.26723 1.71793,0.22906c0.41994,0 0.83988,-0.03818 1.25981,-0.1527c0.30541,-0.07635 0.57264,-0.22906 0.83988,-0.41994c0.19088,-0.1527 0.34359,-0.34359 0.45811,-0.57264c0.19088,-0.45811 0.07635,-0.99258 -0.30541,-1.33617c-0.34359,-0.26723 -0.72535,-0.49629 -1.10711,-0.68717c-0.53447,-0.22906 -1.03076,-0.38176 -1.6034,-0.53447c-0.61082,-0.1527 -1.18346,-0.34359 -1.79428,-0.57264s-1.22164,-0.45811 -1.83246,-0.76352c-0.57264,-0.30541 -1.10711,-0.68717 -1.6034,-1.14529c-0.49629,-0.49629 -0.87805,-1.06893 -1.10711,-1.67975c-0.30541,-0.76352 -0.45811,-1.6034 -0.41994,-2.4051c0,-0.87805 0.19088,-1.71793 0.53447,-2.51963s0.87805,-1.52705 1.56522,-2.09969c0.76352,-0.649 1.64158,-1.10711 2.59598,-1.41252c1.18346,-0.38176 2.44328,-0.57264 3.66491,-0.53447c0.91623,0.03818 1.83246,0.11453 2.71051,0.30541c1.37434,0.26723 2.93957,0.9544 4.23756,1.41252l0.03818,3.16862z"/></svg><span>I'm a web applications developer at Sort. To learn about the projects we deliver, and to discuss your own project, please contact me: <a href="mailto:garion@wearesort.co.uk">garion@wearesort.co.uk</a>.</span></p>
        </footer>
    </div>
    <script src="js/map.js"></script>
    <script src="js/globe.js"></script>
  </body>
</html>
